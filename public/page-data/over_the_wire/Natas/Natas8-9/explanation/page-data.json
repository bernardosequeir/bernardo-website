{"componentChunkName":"component---src-templates-blog-post-js","path":"/over_the_wire/Natas/Natas8-9/explanation/","result":{"data":{"markdownRemark":{"html":"<p>When we open the natas8 page, we are greeted with a form and a link to the source code, as we've seen before. So let's just analyse the logic that controls the form.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?</span>\n\n<span class=\"token variable\">$encodedSecret</span> <span class=\"token operator\">=</span> <span class=\"token double-quoted-string string\">\"3d3d516343746d4d6d6c315669563362\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">encodeSecret</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$secret</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">bin2hex</span><span class=\"token punctuation\">(</span><span class=\"token function\">strrev</span><span class=\"token punctuation\">(</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$secret</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_key_exists</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"submit\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">encodeSecret</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'secret'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$encodedSecret</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">print</span> <span class=\"token double-quoted-string string\">\"Access granted. The password for natas9 is &lt;censored>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">print</span> <span class=\"token double-quoted-string string\">\"Wrong secret\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<p>This might seem confusing and really challenging if you're just starting out but fear not, this isn't really that complicated, it just encodes the secret into base64, reverses the string and then turns the <strong>bin</strong>ary into <strong>hex</strong>adecimal. You might not be completely familiar with base64 or converting binary to hexadecimal but thankfully php (the language in which this is written) has functions that solve this problem. You just need to turn <strong>hex</strong>adecimal to <strong>bin</strong>ary, reverse the string and then decode the data in base64, as seen in the image below.</p>\n<p><img src=\"../Images/Natas8PhpDecode.png\" alt=\"Printscreen of the php code\" title=\"Easy as that\"></p>","frontmatter":{"title":""}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/over_the_wire/Natas/Natas8-9/explanation/"}}}