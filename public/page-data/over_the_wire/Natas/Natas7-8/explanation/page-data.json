{"componentChunkName":"component---src-templates-blog-post-js","path":"/over_the_wire/Natas/Natas7-8/explanation/","result":{"data":{"markdownRemark":{"html":"<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> This stuff in the header has nothing to <span class=\"token keyword\">do</span> with the level <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"stylesheet\"</span> type<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"text/css\"</span> href<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"http://natas.labs.overthewire.org/css/level.css\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"stylesheet\"</span> href<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"http://natas.labs.overthewire.org/css/jquery-ui.css\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"stylesheet\"</span> href<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"http://natas.labs.overthewire.org/css/wechall.css\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"http://natas.labs.overthewire.org/js/jquery-ui.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span>http<span class=\"token punctuation\">:</span><span class=\"token comment\">//natas.labs.overthewire.org/js/wechall-data.js>&lt;/script>&lt;script src=\"http://natas.labs.overthewire.org/js/wechall.js\">&lt;/script></span>\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token keyword\">var</span> wechallinfo <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token double-quoted-string string\">\"level\"</span><span class=\"token punctuation\">:</span> <span class=\"token double-quoted-string string\">\"natas7\"</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"pass\"</span><span class=\"token punctuation\">:</span> <span class=\"token double-quoted-string string\">\"7z3hEENjQtflzgnT29q7wAvMNfZdh0i9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>natas7<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"content\"</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"index.php?page=home\"</span><span class=\"token operator\">></span>Home<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"index.php?page=about\"</span><span class=\"token operator\">></span>About<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>\nthis is the about page\n\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> hint<span class=\"token punctuation\">:</span> password <span class=\"token keyword\">for</span> webuser natas8 is in <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>natas_webpass<span class=\"token operator\">/</span>natas8 <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span></code></pre></div>\n<p>If we analyse the source code, we can see that this application uses only one page, and gets what it displays from a page or file passed as an argument in the href. So we can just intercecpt the request for the webpage using burp and then change the file it was originally requesting with <code class=\"language-text\">/etc/natas_webpass/natas8</code></p>\n<p><img src=\"../Images/Natas7Intercept.png\" alt=\"Printscreen of the intercepted request\" title=\"We just need to change the page value\"></p>\n<p>And there we have it! another level complete.</p>","frontmatter":{"title":""}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/over_the_wire/Natas/Natas7-8/explanation/"}}}